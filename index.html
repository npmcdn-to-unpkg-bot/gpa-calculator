<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>GPA Calculator</title>
		<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
		<style>
		*{
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
		}
		body{
			margin: 0;
			padding: 0;
			background-color: #d8d8d8;
		}
		.app{
			width: 1000px;
			height: auto;
			margin: auto;
			margin-top: 50px;
			padding: 10px;
			border-radius: 4px;
			border: solid 1px #333;
			background-color: #fff;
		}
		.app>.list-group{
			margin-bottom: 0;
		}
		.app .label.label-default{
			margin-left: 5px;
			margin-right: 10px;
		}
		</style>
    <script src="https://npmcdn.com/react@15.3.1/dist/react.js"></script>
    <script src="https://npmcdn.com/react-dom@15.3.1/dist/react-dom.js"></script>
    <script src="https://npmcdn.com/babel-core@5.8.38/browser.min.js"></script>
    <script src="https://npmcdn.com/jquery@3.1.0/dist/jquery.min.js"></script>
		<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/babel">

		let cnt=0;

		const App=React.createClass({
			getInitialState: function(){
				return {
					course: []
				}
			},

			addCourse: function(){
				let c=this.state.course;
				c.push({
					id: cnt++,
					credit: 0,
					score: 0,
				})

				this.setState({
					course: c
				})
			},

			updateCredit: function(credit,id){

				let c=this.state.course;
				for(let i=0;i<c.length;i++){
					if(c[i].id==id){
						c[i].credit=credit;
					}
				}

				this.setState({
					course: c
				});
			},

			updateScore: function(score,id){

				let c=this.state.course;
				for(let i=0;i<c.length;i++){
					if(c[i].id==id){
						c[i].score=score;
					}
				}

				this.setState({
					course: c
				});
			},

			render: function(){
				return(
					<div className="app">
						<div className="list-group">
							<div className="list-group-item list-group-item-info">
								Counted courses <span className="label label-default">{(function(that){
									let cnt=0;
									for(let i=0;i<that.state.course.length;i++){
										if(that.state.course[i].credit>0){
											cnt++;
										}
									}
									return cnt;
								})(this)}</span>
								Weighted average score <span className="label label-default">{(function(that){
									let weightedScoreCnt=0;
									let creditCnt=0;
									for(let i=0;i<that.state.course.length;i++){
										weightedScoreCnt+=((that.state.course[i].score)*(that.state.course[i].credit))
										creditCnt+=((that.state.course[i].credit)*(1));
									}
									return (weightedScoreCnt)/(creditCnt);
								})(this)}</span>
							</div>

							{this.state.course.map(function(item,i){
								return (
									<div className="list-group-item" key={i}>
										<div className="row">
											<div className="col-lg-6">
												<div className="input-group">
													<span className="input-group-addon">Course name</span>
													<input type="text" className="form-control"/>
												</div>
											</div>
											<div className="col-lg-3">
												<div className="input-group">
													<span className="input-group-addon">Credit</span>
													<input type="text" className="form-control" onChange={(event)=>{this.updateCredit(event.target.value,item.id)}}/>
												</div>
											</div>
											<div className="col-lg-3">
												<div className="input-group">
													<span className="input-group-addon">Score</span>
													<input type="text" className="form-control" onChange={(event)=>{this.updateScore(event.target.value,item.id)}}/>
												</div>
											</div>
										</div>
									</div>
								)
							},this)}
							<a href="#" className="list-group-item" onClick={this.addCourse}>Add Course <span className="glyphicon glyphicon-plus"></span></a>
						</div>
					</div>
				)
			}
		});

		//render
		ReactDOM.render(
			<App/>,
			document.getElementById("app")
		);
		</script>
  </body>
</html>
